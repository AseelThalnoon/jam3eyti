<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>جمعيّتي البسيطة</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<header class="bar">
  <h1>جمعيّتي</h1>
  <button id="addToHome" class="ghost">أضف للشاشة الرئيسية</button>
</header>

<main class="wrap">
  <section class="card">
    <h2>إعدادات الجمعية</h2>
    <div class="grid">
      <label>اسم الجمعية
        <input id="assocName" type="text" placeholder="مثال: جمعية العائلة">
      </label>
      <label>الدورية
        <select id="frequency">
          <option value="monthly">شهري</option>
          <option value="weekly">أسبوعي</option>
          <option value="daily">يومي</option>
        </select>
      </label>
      <label>تاريخ البداية
        <input id="startDate" type="date">
      </label>
    </div>
  </section>

  <section class="card">
    <h2>الأعضاء ومبالغ الدفع</h2>
    <div class="row">
      <input id="memberName" class="grow" type="text" placeholder="اسم العضو">
      <input id="memberPay" type="number" min="1" step="1" placeholder="المبلغ لكل دورة (SAR)">
      <button id="addMember">إضافة</button>
    </div>

    <table id="membersTable">
      <thead>
        <tr>
          <th>#</th><th>العضو</th><th>يدفع/دورة</th><th>أدواره المحسوبة</th><th>إجمالي استلامه</th><th></th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr>
          <td colspan="2"><b>إجمالي المساهمات (قيمة الصندوق/الدورة)</b></td>
          <td id="sumPay" colspan="4">0</td>
        </tr>
      </tfoot>
    </table>

    <div class="muted tiny">
      ملاحظة: نحسب الأدوار تلقائيًا بنسبة المساهمة. أقل مساهمة تصبح «وحدة» ونحوّل الباقي تلقائيًا.
    </div>
    <div class="actions">
      <button id="buildRota" class="primary">توليد جدول الاستلام</button>
      <button id="clearMembers" class="danger">مسح الأعضاء</button>
    </div>
  </section>

  <section class="card">
    <h2>الجدول (ترتيب الاستلام)</h2>
    <div class="row">
      <button id="shuffle">خلط الترتيب</button>
      <button id="sortByPay">ترتيب حسب الأعلى دفعًا</button>
      <button id="goToday">انتقال لدورة اليوم</button>
    </div>
    <table id="rotaTable">
      <thead>
        <tr><th>الدورة</th><th>التاريخ</th><th>المستلم</th><th>قيمة الاستلام</th></tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section class="card">
    <h2>مدفوعات الدورة الحالية</h2>
    <div class="row">
      <label>الدورة:
        <select id="cycleSelect"></select>
      </label>
      <button id="markAllPaid">تحديد الجميع مدفوع</button>
      <button id="resetCycle" class="danger">مسح مدفوعات الدورة</button>
    </div>
    <table id="paymentsTable">
      <thead><tr><th>العضو</th><th>مستحق عليه</th><th>دفع؟</th><th>التاريخ</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>

  <section class="card">
    <h2>نسخ احتياطي وتصدير</h2>
    <div class="row wrap">
      <button id="backupJSON">نسخ احتياطي JSON</button>
      <label class="file">
        استعادة من JSON
        <input id="importJSON" type="file" accept="application/json">
      </label>
      <button id="exportCSV">تصدير CSV</button>
      <button id="printView">طباعة</button>
    </div>
    <div class="muted tiny">كل البيانات محليًا في المتصفح (LocalStorage).</div>
  </section>
</main>

<footer class="muted center tiny">© 2025 — يعمل بدون خادم.</footer>

<script src="app.js"></script>
</body>
</html>